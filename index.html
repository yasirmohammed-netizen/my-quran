<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>مصحف الهداية الرقمي</title>
    <style>
        /* التنسيق (CSS) مدمج هنا */
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f4f1ea;
            color: #2c3e50;
            margin: 0;
            padding: 20px;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }
        header {
            text-align: center;
            border-bottom: 2px solid #e0d8c3;
            padding-bottom: 20px;
        }
        #surah-select {
            width: 100%;
            padding: 12px;
            font-size: 1.1rem;
            margin: 20px 0;
            border-radius: 8px;
            border: 1px solid #bdc3c7;
            background-color: #fff;
        }
        #quran-display {
            line-height: 2.5;
            font-size: 1.6rem;
            text-align: justify;
            min-height: 300px;
        }
        .ayah {
            cursor: pointer;
            transition: 0.3s;
            padding: 2px 5px;
        }
        .ayah:hover {
            background-color: #f1c40f44;
        }
        .ayah-num {
            color: #27ae60;
            font-weight: bold;
            font-size: 1rem;
            margin: 0 5px;
        }
        .welcome-msg { text-align: center; color: #7f8c8d; }
        #bookmark-info {
            background: #e8f5e9;
            padding: 10px;
            border-radius: 8px;
            margin-top: 10px;
            font-size: 0.9rem;
            display: none;
        }
        .bookmark-btn {
            background: #27ae60;
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 4px;
            cursor: pointer;
            margin-right: 10px;
        }
    </style>
</head>
<body>

    <div class="container">
        <header>
            <h1>القرآن الكريم</h1>
            <div id="bookmark-info"></div>
        </header>

        <select id="surah-select">
            <option value="">جاري تحميل الفهرس...</option>
        </select>

        <main id="quran-display">
            <p class="welcome-msg">الرجاء اختيار سورة من القائمة للبدء بالقراءة.</p>
        </main>
    </div>

    <script>
        /* البرمجة (JS) مدمجة هنا */
        const surahSelect = document.getElementById('surah-select');
        const quranDisplay = document.getElementById('quran-display');
        const bookmarkInfo = document.getElementById('bookmark-info');

        // جلب الفهرس
        async function loadSurahs() {
            try {
                const response = await fetch('https://api.alquran.cloud/v1/surah');
                const data = await response.json();
                surahSelect.innerHTML = '<option value="">اختر السورة...</option>';
                data.data.forEach(surah => {
                    const option = document.createElement('option');
                    option.value = surah.number;
                    option.textContent = `${surah.number}. ${surah.name}`;
                    surahSelect.appendChild(option);
                });
            } catch (err) {
                surahSelect.innerHTML = '<option>خطأ في تحميل البيانات</option>';
            }
        }

        // جلب السورة
        async function loadAyahs(surahNumber) {
            if (!surahNumber) return;
            quranDisplay.innerHTML = "<p class='welcome-msg'>جاري تحميل الآيات...</p>";
            const response = await fetch(`https://api.alquran.cloud/v1/surah/${surahNumber}`);
            const data = await response.json();
            displayQuran(data.data);
        }

        function displayQuran(surahData) {
            quranDisplay.innerHTML = `<h2 style="text-align:center; color:#2c3e50;">${surahData.name}</h2>`;
            surahData.ayahs.forEach(ayah => {
                const ayahSpan = document.createElement('span');
                ayahSpan.className = 'ayah';
                ayahSpan.innerHTML = `${ayah.text} <span class="ayah-num">(${ayah.numberInSurah})</span> `;
                ayahSpan.onclick = () => saveBookmark(surahData.name, surahData.number, ayah.numberInSurah);
                quranDisplay.appendChild(ayahSpan);
            });
        }

        function saveBookmark(name, sNum, aNum) {
            const bookmark = { name, sNum, aNum };
            localStorage.setItem('quranBookmark', JSON.stringify(bookmark));
            displayCurrentBookmark();
            alert(`تم حفظ العلامة عند آية ${aNum}`);
        }

        function displayCurrentBookmark() {
            const saved = JSON.parse(localStorage.getItem('quranBookmark'));
            if (saved) {
                bookmarkInfo.style.display = 'block';
                bookmarkInfo.innerHTML = `
                    آخر ما وصلت إليه: <b>${saved.name}</b> (آية ${saved.aNum})
                    <button class="bookmark-btn" onclick="loadAyahs(${saved.sNum})">انتقال سريع</button>
                `;
            }
        }

        surahSelect.onchange = (e) => loadAyahs(e.target.value);
        loadSurahs();
        displayCurrentBookmark();
    </script>
</body>
</html>
